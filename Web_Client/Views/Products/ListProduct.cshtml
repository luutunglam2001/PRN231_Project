@using DataAccsess.Models;

@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
  
}
@inject IHttpContextAccessor HttpContextAccessor;

<!DOCTYPE html>
<script src="~/bootstrap/js - copy/scripts.js"></script>
<link href="~/bootstrap/css - copy/styles.css" rel="stylesheet" />
<a href="~/bootstrap/index - copy.html"></a>
<html lang="en">
<style>
        .button-page {
        padding-left: 50%;
    }

    .col-md-8.col-xl-4 {
        display: flex;
        margin-right: 70px;
    }
    h3.nav-link.text-dark {
        font-size: 20px;
    }
    header{
        width: 100%;
        height: 400px;
        background-image: url('https://cdn-www.vinid.net/2020/09/8cb97047-tr%C3%A0-s%E1%BB%AFa-pozaa-tea-%C6%B0u-%C4%91%C3%A3i.jpg');
        background-size: cover;
        background-position: center;
    }

</style>    
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Shop Homepage</title>
    <!-- Favicon-->
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <!-- Bootstrap icons-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="css/styles.css" rel="stylesheet" />
</head>
<body>
    <!-- Navigation-->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container px-4 px-lg-5">
          
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0 ms-lg-4">
                    <li class="nav-item">
                        <a class="nav-link text-dark" asp-area="" asp-action="ListProduct">Home</a>
                    <li class="nav-item"><a class="nav-link" href="#!">About</a></li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Shop</a>
                      @*  <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                                @foreach (var c in ViewData["category"] as List<Category>)
                                {
                                  <li><a class="dropdown-item">@c.CategoryName</a></li>
                                 }
                            
                        </ul>*@
                    </li>
                    </li>
                    @{
                        string user = HttpContextAccessor.HttpContext.Session.GetString("UserName") ?? "";
                        int accRole = HttpContextAccessor.HttpContext.Session.GetInt32("role") ?? 5;
                    }
                    @{
                    
                    if (accRole == 0)
                    {
                    <li class="nav-item">
                        <h3 class="nav-link text-dark">Welcome (@user)</h3>
                    </li>
                    }
                    if (accRole == 5)
                    {
                            <li>
                                <a asp-action="Login" asp-controller="Users" class="btn btn-primary btn-lg active" role="button" aria-pressed="true"> Login</a>
                            </li>
                    }
                    else
                    {
                            <li>
                                <a asp-action="Logout" asp-controller="Users" class="btn btn-primary btn-lg active" role="button" aria-pressed="true">Logout</a>
                            </li>
                    }
                 }
                </ul>
            
                 <form method="post">
                         <div class="col-md-8 col-xl-4">
                        <input type="text" name="searchpname" placeholder="Search by name" value="@ViewData["searchpname"]">
                        <button type="submit" class="btn btn-primary">Search</button>
                       </div>
               </form>
              
                <form class="d-flex">
                    <button asp-action="Index" asp-controller="Cart" class="btn btn-outline-dark" type="submit">
                        <i class="bi-cart-fill me-1"></i>
                        Cart
                        <span class="badge bg-dark text-white ms-1 rounded-pill">@ViewData["count"]</span>
                    </button>
                </form>
            </div>
        </div>
    </nav>
    <!-- Header-->
    <header class="bg-dark py-5">
        <div class="container px-4 px-lg-5 my-5">
            <div class="text-center text-white">
                @*<img class="img-shop" src="https://cdn-www.vinid.net/2020/09/8cb97047-tr%C3%A0-s%E1%BB%AFa-pozaa-tea-%C6%B0u-%C4%91%C3%A3i.jpg" alt="..." />*@
            </div>
        </div>
    </header>
    <!-- Section-->
    <section class="py-5">
        <div style="width=30%; float:left">
            <h1>List of categories</h1>

           @* <form asp-controller="Products" method="post">
                <select name="cateId" onchange="this.form.submit()">
                    <option>All</option>
                    @foreach (var c in ViewData["category"] as List<Category>)
                    {
                        @if (ViewData["cateId"] != null)
                        {
                            @if (c.CategoryId == (int)ViewData["cateId"])
                            {
                                <option selected value="@c.CategoryId">@c.CategoryName</option>
                            }
                            else
                            {
                                <option value="@c.CategoryId">@c.CategoryName</option>
                            }
                        }
                        else
                        {
                            <option value="@c.CategoryId">@c.CategoryName</option>

                        }
                    }
                </select>
            </form>*@
           

            <form asp-controller="Products" method="post">
                <select class="form-select form-select-lg mb-3" aria-label=".form-select-lg example" name="cateId" onchange="this.form.submit()">
                    <option>All</option>
                    @foreach (var c in ViewData["category"] as List<Category>)
                    {
                        <option value="@c.CategoryId" selected="@(c.CategoryId == (int)ViewData["datac"])">@c.CategoryName</option>
                    }
                </select>
            </form>
           
        </div>
        <div class="container px-4 px-lg-5 mt-5">
           
            <div class="row gx-4 gx-lg-5 row-cols-2 row-cols-md-3 row-cols-xl-4 justify-content-center">
                @foreach (var p in Model)
                { 
                <div class="col mb-5">
                    <div class="card h-100">
                        <!-- Product image-->
                        <img class="card-img-top" src="@p.Picture" alt="..." />
                        <!-- Product details-->
                        <div class="card-body p-4">
                            <div class="text-center">
                                <!-- Product name-->
                                <h5 class="fw-bolder">@p.ProductName</h5>
                                <!-- Product price-->
                               @p.UnitPrice
                            </div>
                        </div>
                        <!-- Product actions-->
                      @{
                        if(accRole == 0){
                          <div class="card-footer p-4 pt-0 border-top-0 bg-transparent">
                            <div class="text-center">
                                            <a name="cartss" class="btn btn-outline-dark mt-auto" asp-action="Index" asp-controller="Cart" asp-route-id="@p.ProductId">Add to cart</a>
                                </div>
                             </div>
                            }
                            if(accRole == 5){
                            <div class="card-footer p-4 pt-0 border-top-0 bg-transparent">
                                <div class="text-center">
                                            <a class="btn btn-outline-dark mt-auto" asp-action="Login" asp-controller="Users" >Add to cart</a>
                                </div>
                            </div>
                            }
                    }
                    </div>
                 </div>
                 }
            </div>
        </div>
        <div class="button-page">
            @if ((int)ViewBag.CurrentPage > 1)
            {
                <button onclick="window.location.href='@Url.Action("ListProduct", new { cateId = ViewBag.CategoryId,searchpname = (string)ViewData["searchpname"],page = ViewBag.CurrentPage - 1 })'">Previous</button>
            }

            <!-- Hiển thị số trang -->
            @for (int i = 1; i <= (int)ViewBag.TotalPages; i++)
            {
                if (i == ViewBag.CurrentPage)
                {
                    <button disabled="disabled" onclick="window.location.href='@Url.Action("ListProduct", new {cateId = ViewBag.CategoryId, searchpname = (string)ViewData["searchpname"], page = i })'">@i</button>
                }
                else
                {
                    <button onclick="window.location.href='@Url.Action("ListProduct", new {cateId = ViewBag.CategoryId, searchpname = (string)ViewData["searchpname"], page = i })'">@i</button>
                }
            }

            <!-- Nút điều hướng trang tiếp theo -->
            @if ((int)ViewBag.CurrentPage < (int)ViewBag.TotalPages)
            {
                <button onclick="window.location.href='@Url.Action("ListProduct", new {cateId = ViewBag.CategoryId,searchpname = (string)ViewData["searchpname"], page = ViewBag.CurrentPage + 1 })'">Next</button>
            }
        </div>
        
    </section>
   
    <footer class="bg-light text-center text-lg-start">
       
        <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
            © 2020 Copyright:
            <a class="text-dark" href="https://mdbootstrap.com/">adminpage@gmail.com</a>
            <p><i class="fas fa-phone me-3 text-secondary"></i> +84 5167789321</p>
        </div>
       
    </footer>
    <!-- Bootstrap core JS-->
   @* <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>*@
    <!-- Core theme JS-->
    <script src="js/scripts.js"></script>
</body>


</html>